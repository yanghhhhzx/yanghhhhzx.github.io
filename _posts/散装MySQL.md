# InnoDB事务隔离级别
事务隔离级别是指在数据库系统中，‌定义了一个事务可能受其他并发事务影响的程度。‌它主要用于控制并发事务之间的相互影响，‌确保数据的一致性和完整性。‌

InnoDB存储引擎的默认事务隔离级别是可重复读（‌Repeatable Read）‌。‌在这种隔离级别下，‌一个事务在执行期间多次读取同一数据时，‌结果是一致的，‌避免了不可重复读的问题，‌但可能存在幻读现象。‌

要切换事务隔离级别，‌可以使用SQL语句。‌例如，‌在MySQL中，‌可以使用`SET [SESSION | GLOBAL] TRANSACTION ISOLATION LEVEL {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE}`语句来设置会话或全局的事务隔离级别‌

在MySQL中，‌读已提交（‌Read Committed）‌和可重复读（‌Repeatable Read）‌这两种隔离级别采用了MVCC（‌多版本并发控制）‌机制。‌读已提交隔离级别下，‌事务中的每次读取都会生成一个新的read view，‌可能导致多次读取同一数据结果不一致。‌而在可重复读隔离级别下，‌事务开始时生成一个read view，‌整个事务期间都使用这个read view，‌保证了事务期间读取的数据都是事务开始前的记录，‌从而避免了不可重复读的问题。‌

串行化（‌Serializable）‌隔离级别则采取加锁机制，‌通过完全串行化的方式执行事务，‌避免并发带来的问题，‌但性能较差。

## MVCC
其实就是只能读最小的提交版本，或者是该事务自己正在操作的版本。

undolog来记录历史版本，readview用来记录当前活跃事务（只需要知道最小id和最大id）。

每个事务一提交，最小版本就变了。因为最小提交版本是不断变化的，及时一直不清除undolog也不会出现一直读低版本的问题。

# 慢查询

## 定位慢查询
1. 可以用第三方工具
2. MYSQL提供了慢查询的日志。可以看mysql的慢sql日志

# 索引
B树的缺点：
为什么索引要用b+树，因为B树做不了范围查询。B+树的每个叶子节点都相互连接，所以范围查询可以直接查两个端点就行了。

但是b树因为在其他非叶子节点存了消息，就没办法像B+树一样去查了。

